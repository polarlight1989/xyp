var HttpStr="<table width='700' border='0' cellpadding='0' cellspacing='1' class='Ball_List'>";
HttpStr+="  <tr>";
HttpStr+="    <td width='80' class='td_caption_1 F_bold'>今天</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>01</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>02</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>03</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>04</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>05</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>06</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>07</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>08</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>09</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>10</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>11</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>12</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>13</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>14</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>15</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>16</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>17</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_B'>18</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_R'>19</td>";
HttpStr+="    <td width='31' class='td_caption_1 F_bold Font_R'>20</td>";
HttpStr+="  </tr>";
HttpStr+="  <tr class='Ball_tr_H'>";
HttpStr+="    <td class='t_list_tr_1 F_bold'>出 球 率</td>";
HttpStr+="    <td id='cqNO_1'>0</td>";
HttpStr+="    <td id='cqNO_2'>0</td>";
HttpStr+="    <td id='cqNO_3'>0</td>";
HttpStr+="    <td id='cqNO_4'>0</td>";
HttpStr+="    <td id='cqNO_5'>0</td>";
HttpStr+="    <td id='cqNO_6'>0</td>";
HttpStr+="    <td id='cqNO_7'>0</td>";
HttpStr+="    <td id='cqNO_8'>0</td>";
HttpStr+="    <td id='cqNO_9'>0</td>";
HttpStr+="    <td id='cqNO_10'>0</td>";
HttpStr+="    <td id='cqNO_11'>0</td>";
HttpStr+="    <td id='cqNO_12'>0</td>";
HttpStr+="    <td id='cqNO_13'>0</td>";
HttpStr+="    <td id='cqNO_14'>0</td>";
HttpStr+="    <td id='cqNO_15'>0</td>";
HttpStr+="    <td id='cqNO_16'>0</td>";
HttpStr+="    <td id='cqNO_17'>0</td>";
HttpStr+="    <td id='cqNO_18'>0</td>";
HttpStr+="    <td id='cqNO_19'>0</td>";
HttpStr+="    <td id='cqNO_20'>0</td>";
HttpStr+="  </tr>";
HttpStr+="  <tr class='Ball_tr_H'>";
HttpStr+="    <td class='t_list_tr_1 F_bold'>無出期數</td>";
HttpStr+="    <td id='dbNO_1'></td>";
HttpStr+="    <td id='dbNO_2'></td>";
HttpStr+="    <td id='dbNO_3'></td>";
HttpStr+="    <td id='dbNO_4'></td>";
HttpStr+="    <td id='dbNO_5'></td>";
HttpStr+="    <td id='dbNO_6'></td>";
HttpStr+="    <td id='dbNO_7'></td>";
HttpStr+="    <td id='dbNO_8'></td>";
HttpStr+="    <td id='dbNO_9'></td>";
HttpStr+="    <td id='dbNO_10'></td>";
HttpStr+="    <td id='dbNO_11'></td>";
HttpStr+="    <td id='dbNO_12'></td>";
HttpStr+="    <td id='dbNO_13'></td>";
HttpStr+="    <td id='dbNO_14'></td>";
HttpStr+="    <td id='dbNO_15'></td>";
HttpStr+="    <td id='dbNO_16'></td>";
HttpStr+="    <td id='dbNO_17'></td>";
HttpStr+="    <td id='dbNO_18'></td>";
HttpStr+="    <td id='dbNO_19'></td>";
HttpStr+="    <td id='dbNO_20'></td>";
HttpStr+="  </tr>";
HttpStr+="</table>";
HttpStr+="<table width='700' border='0' cellpadding='0' cellspacing='1' class='Ball_List'>";
HttpStr+="  <tr>";
HttpStr+="    <td class='td_caption_2 F_bold' ID='sRB_1'><a href='javascript:void(0)' onClick='Read_Ballimg(1)' onFocus='this.blur()'>第￥球</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_2'><a href='javascript:void(0)' onClick='Read_Ballimg(2)' onFocus='this.blur()'>大小</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_3'><a href='javascript:void(0)' onClick='Read_Ballimg(3)' onFocus='this.blur()'>單雙</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_4'><a href='javascript:void(0)' onClick='Read_Ballimg(4)' onFocus='this.blur()'>尾數大小</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_5'><a href='javascript:void(0)' onClick='Read_Ballimg(5)' onFocus='this.blur()'>合數單雙</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_6'><a href='javascript:void(0)' onClick='Read_Ballimg(6)' onFocus='this.blur()'>方位</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_7'><a href='javascript:void(0)' onClick='Read_Ballimg(7)' onFocus='this.blur()'>中發白</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_8'><a href='javascript:void(0)' onClick='Read_Ballimg(8)' onFocus='this.blur()'>總和大小</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_9'><a href='javascript:void(0)' onClick='Read_Ballimg(9)' onFocus='this.blur()'>總和單雙</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_10'><a href='javascript:void(0)' onClick='Read_Ballimg(10)' onFocus='this.blur()'>總和尾數大小</a></td>";
HttpStr+="    <td class='td_caption_1 F_bold' ID='sRB_11'><a href='javascript:void(0)' onClick='Read_Ballimg(11)' onFocus='this.blur()'>龍虎</a></td>";
HttpStr+="  </tr>";
HttpStr+="  <tr class='Ball_tr_H'>";
HttpStr+="    <td colspan='11'>";
HttpStr+="<table width='696' border='0' cellpadding='0' cellspacing='1' class='Ball_List'>";
HttpStr+="  <tr class='Ball_tr_H' valign='top'>";
HttpStr+="    <td id='bXT_1' width='28'></td>";
HttpStr+="    <td id='bXT_2' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_3' width='28'></td>";
HttpStr+="    <td id='bXT_4' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_5' width='28'></td>";
HttpStr+="    <td id='bXT_6' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_7' width='28'></td>";
HttpStr+="    <td id='bXT_8' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_9' width='28'></td>";
HttpStr+="    <td id='bXT_10' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_11' width='28'></td>";
HttpStr+="    <td id='bXT_12' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_13' width='28'></td>";
HttpStr+="    <td id='bXT_14' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_15' width='28'></td>";
HttpStr+="    <td id='bXT_16' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_17' width='28'></td>";
HttpStr+="    <td id='bXT_18' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_19' width='28'></td>";
HttpStr+="    <td id='bXT_20' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_21' width='28'></td>";
HttpStr+="    <td id='bXT_22' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_23' width='28'></td>";
HttpStr+="    <td id='bXT_24' width='28' class='Jut_caption_1'></td>";
HttpStr+="    <td id='bXT_25' width='28'></td>";
HttpStr+="  </tr>";
HttpStr+="</table>";

var HttpStr2="<table width='700' border='0' cellpadding='0' cellspacing='1' class='Ball_List'>";
HttpStr2+="  <tr>";
HttpStr2+="    <td class='td_caption_2 F_bold' ID='sRB_1'><a href='javascript:void(0)' onClick='Read_Ballimg(1)' onFocus='this.blur()'>冠、亞軍和</a></td>";
HttpStr2+="    <td class='td_caption_1 F_bold' ID='sRB_8'><a href='javascript:void(0)' onClick='Read_Ballimg(8)' onFocus='this.blur()'>冠、亞軍和 大小</a></td>";
HttpStr2+="    <td class='td_caption_1 F_bold' ID='sRB_9'><a href='javascript:void(0)' onClick='Read_Ballimg(9)' onFocus='this.blur()'>冠、亞軍和 單雙</a></td>";
HttpStr2+="  </tr>";
HttpStr2+="  <tr class='Ball_tr_H'>";
HttpStr2+="    <td colspan='11'>";
HttpStr2+="<table width='696' border='0' cellpadding='0' cellspacing='1' class='Ball_List'>";
HttpStr2+="  <tr class='Ball_tr_H' valign='top'>";
HttpStr2+="    <td id='bXT_1' width='28'></td>";
HttpStr2+="    <td id='bXT_2' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_3' width='28'></td>";
HttpStr2+="    <td id='bXT_4' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_5' width='28'></td>";
HttpStr2+="    <td id='bXT_6' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_7' width='28'></td>";
HttpStr2+="    <td id='bXT_8' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_9' width='28'></td>";
HttpStr2+="    <td id='bXT_10' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_11' width='28'></td>";
HttpStr2+="    <td id='bXT_12' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_13' width='28'></td>";
HttpStr2+="    <td id='bXT_14' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_15' width='28'></td>";
HttpStr2+="    <td id='bXT_16' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_17' width='28'></td>";
HttpStr2+="    <td id='bXT_18' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_19' width='28'></td>";
HttpStr2+="    <td id='bXT_20' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_21' width='28'></td>";
HttpStr2+="    <td id='bXT_22' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_23' width='28'></td>";
HttpStr2+="    <td id='bXT_24' width='28' class='Jut_caption_1'></td>";
HttpStr2+="    <td id='bXT_25' width='28'></td>";
HttpStr2+="  </tr>";
HttpStr2+="</table>";

var Sel_Type=1;

var Ballimg_A = new Array();

//加載盤紙
var LSL_XmlActiveX=new ActiveXObject("Microsoft.XMLDOM");

function LSL_Load() {
    var GYh=0;
    if (T==18 || T==21){
        Sel_Type=1;
        document.getElementById("LSL_Http").innerHTML=HttpStr2;
        GYh=1;
//    } else {
//        Sel_Type=1;
//        document.getElementById("LSL_Http").innerHTML=HttpStr.replace("￥",T);
    }
    
    LSL_XmlActiveX.onreadystatechange=LSL_XmlReady;
    LSL_XmlActiveX.async="true";
    LSL_XmlActiveX.load("xml/Read_LSL.php?LT=4&UVID=" + UVID + "&NO=" + T + "&GYh=" + GYh);
}
function LSL_XmlReady() {    
    if (LSL_XmlActiveX.readyState==4) {
        var xml=LSL_XmlActiveX.documentElement;
        LSL_XmlTraverse(xml);
    }
}

var a_LSL_0;
var a_LSL_b;
var a_LSL_9;

function LSL_XmlTraverse(pnode) {
    var l=pnode.childNodes.length;
    for(var i=0;i<l;i++) {
        var node=pnode.childNodes[i];
        if (node.tagName=="LandErr") { //error
            if (node.text=="EXIT") top.location.href = "../"; 
        } else if (node.tagName=="RunResult") {
            if (node.text.length>=3) {
                var RR_Array=new String(node.text).split(",");
                var RR_Html="<table width='167' border='0' cellpadding='0' cellspacing='1' class='t_list'><tr><td colspan='6' class='t_list_caption F_bold'>近期開獎結果</td></tr>";
                for(var RR_I=0;RR_I<RR_Array.length;RR_I++) {
                    RR_Html+="<tr class='Ball_tr_H'>";
                    RR_Html+="<td width='35'>" + RR_Array[RR_I].substr(0,2) + "期</td>";
                    RR_Html+="<td class='No_" + RR_Array[RR_I].substr(2,1) + "' width='27'></td>";
                    RR_Html+="<td class='No_" + RR_Array[RR_I].substr(3,1) + "' width='27'></td>";
                    RR_Html+="<td class='No_" + RR_Array[RR_I].substr(4,1) + "' width='27'></td>";
                    var No_Sum=Number(RR_Array[RR_I].substr(2,1))+Number(RR_Array[RR_I].substr(3,1))+Number(RR_Array[RR_I].substr(4,1));
                    RR_Html+="<td width='24'>" + No_Sum + "</td>";
                    if (RR_Array[RR_I].substr(2,1)==RR_Array[RR_I].substr(3,1) && RR_Array[RR_I].substr(2,1)==RR_Array[RR_I].substr(4,1)){
                        RR_Html+="<td width='30' class='Font_G'>通吃</td>";
                    } else {
                        if (No_Sum>10){
                            RR_Html+="<td width='30' class='Font_r'>大</td>";
                        } else {
                            RR_Html+="<td width='30'>小</td>";
                        }
                    }
                    RR_Html+="</tr>";
                }
                RR_Html+="</table>";
                document.getElementById("RR_DIV").innerHTML=RR_Html;
                document.getElementById("RR_DIV").style.top = 11;
                document.getElementById("RR_DIV").style.left = 713;
                document.getElementById("RR_DIV").style.display="block";
                RR_Html="";
            }
        }
    }
}

function Read_Ballimg(t_ST) {
    if (t_ST > 0) {
        document.getElementById("sRB_" + Sel_Type).className="td_caption_1 F_bold";
        Sel_Type=t_ST;
        document.getElementById("sRB_" + Sel_Type).className="td_caption_2 F_bold";
    }
    var a_LSL=a_LSL_b;
    if (Sel_Type==1 || Sel_Type==8 || Sel_Type==9){
        a_LSL=a_LSL_0;
    } else if (Sel_Type==11){
        a_LSL=a_LSL_9;
    }
    
    for(var i=1;i<=25;i++) {
        document.getElementById("bXT_" + i).innerHTML="";
    }

    if (a_LSL.length==1) return;
    
    var Ballimg_A = new Array();
    var B_I=0;
    var t_BS="";
    var t_BS_UP="";
    var t_Color="";

    for(var i=0;i<a_LSL.length;i++) {
		switch(Sel_Type) {
		  case 1 :
            t_BS=a_LSL[i];
            break;
		  case 8 :
            if (Number(a_LSL[i])>11){
                t_BS="大";
            } else {
                t_BS="小"
            }
            break;
		  case 9 :
            if (Number(a_LSL[i]) % 2 == 1){
                t_BS="單";
            } else {
                t_BS="雙"
            }
            break;
 	    }
 	    if (t_BS_UP!=t_BS){
 	        t_BS_UP=t_BS;
 	        B_I++;
 	    }
 	    if (Ballimg_A[B_I]==undefined){
 	        Ballimg_A[B_I]=t_BS;
 	    } else {
 	        Ballimg_A[B_I]+="<br>" + t_BS;
 	    }
    }
    var C_i=25;
    for(var i=Ballimg_A.length-1;i>=1;i--) {
        document.getElementById("bXT_" + C_i).innerHTML=Ballimg_A[i];
        C_i--;
        if (C_i==0) break;
    }
}